"use strict";(self.webpackChunkcomponents=self.webpackChunkcomponents||[]).push([[544],{3420:(S,E,i)=>{i.r(E),i.d(E,{TextSelectModule:()=>d});var o=i(4104),p=i(8284),f=i(4911),r=i(4966),g=i(5839),_=i(1652),x=i(2996);const a="data-select-index",b="highlight-state";let c=class N{get container(){const e=this.el.nativeElement;let t=e.firstElementChild;return"DIV"!==t.tagName&&(t=document.createElement("div"),e.insertBefore(t,e.firstElementChild)),t.className="cursor-pointer","free"===this.state.mode&&(t.className="cursor-text"),t}constructor(e,t,n){this.injector=e,this.el=t,this.cssPipe=n,this.stateChange=new r.vpe}onChangeState(){switch(this.state.mode){case"units":this.renderModeUnits();break;case"free":this.renderModeFree();break;default:this.renderModeRegex()}this.highlightSelections()}onMouseUp(e){"free"===this.state.mode?this.createSelectionFromMouse():this.createSelectionFromEvent(e)}createSelectionFromMouse(){const e=(window.getSelection||document.getSelection)(),t=e?.anchorNode?.parentElement,n=e?.focusNode?.parentElement,s=Number.parseInt(t?.getAttribute(a)||"",10),l=Number.parseInt(n?.getAttribute(a)||"",10);if(Number.isNaN(s)||Number.isNaN(l))return;const u=Math.min(s,l),h=Math.max(s,l),C=this.state.selections;for(let M=0;M<C.length;M++){const T=C[M];if("object"==typeof T.position){const v=T.position;if(u>=v[0]&&u<=v[1]||h>=v[0]&&u<=v[1])return void C.splice(M,1)}}this.state.selections.push({position:[u,h]})}createSelectionFromEvent(e){if(!(e.target instanceof HTMLElement))return;const t=this.container;let n=e.target;if(t.isSameNode(n)||!t.contains(n))return;for(;null==n.getAttribute(a);)if(n=n.parentElement,null==n||n.isSameNode(t))return;const s=Number.parseInt(n.getAttribute(a)||"",10);if(!Number.isNaN(s)){let l=0;for(const u of this.state.selections){if(u.position===s)return void this.state.selections.splice(l,1);l++}this.state.selections.push({position:s})}}renderModeFree(){this.container.innerHTML=this.state.text.trim();let e=0;const t=n=>{if(n.nodeType!==Node.TEXT_NODE)Array.from(n.childNodes).forEach(s=>t(s));else{const s=document.createElement("span");for(const l of n.textContent){if("\n"===l)continue;const u=document.createElement("span");u.innerText=l,u.setAttribute(a,(e++).toString()),s.appendChild(u)}n.parentElement?.replaceChild(s,n)}};t(this.container)}renderModeUnits(){let e=0;this.container.innerHTML=this.state.text.replace(/\{([^}]+?)\}/gm,(t,n)=>`<span ${a}="${e++}">${n}</span>`)}renderModeRegex(){let e=0;this.container.innerHTML=this.state.text.trim().replace(new RegExp(this.state.regex||"","gm"),t=>`<span ${a}="${e++}">${t}</span>`)}highlightRange(e,t,n){const s=this.container,l=[];for(let u=e;u<=t;u++){const h=s.querySelector(`[${a}="${u}"]`);h&&(h.className=n||b,l.push(h.innerHTML))}return l.join("")}highlightSelections(){const e=this.container;e.querySelectorAll(`[${a}]`).forEach(t=>{t.className=""}),this.state.selections.forEach(t=>{const n=this.cssPipe.transform(t.css,"class");if("number"==typeof t.position){const s=e.querySelector(`[${a}="${t.position}"]`);s&&(s.className=n||b,t.content!==s.textContent&&(t.content=s.textContent))}else{const s=this.highlightRange(t.position[0],t.position[1],n);t.content!==s&&(t.content=s)}})}static#t=this.\u0275fac=function(t){return new(t||N)(r.Y36(r.zs3),r.Y36(r.SBq),r.Y36(p.j))};static#e=this.\u0275cmp=r.Xpm({type:N,selectors:[["wc-text-select"]],hostBindings:function(t,n){1&t&&r.NdJ("mouseup",function(l){return n.onMouseUp(l)})},inputs:{state:"state"},outputs:{stateChange:"stateChange"},decls:1,vars:1,consts:[[3,"state","stateChange"]],template:function(t,n){1&t&&(r.TgZ(0,"wc-base",0),r.NdJ("stateChange",function(l){return n.state=l}),r.qZA()),2&t&&r.Q6J("state",n.state)},dependencies:[x.H],styles:["[_nghost-%COMP%]  .cursor-pointer{cursor:pointer}[_nghost-%COMP%]  .cursor-text{cursor:text}[_nghost-%COMP%]  .highlight-state{border-top:1px solid transparent;border-bottom:1px solid transparent;color:var(--brand-color-primary);background-color:#cce5ff;border-color:#b8daff}[_nghost-%COMP%]  .error-state, [_nghost-%COMP%]  .warning-state, [_nghost-%COMP%]  .success-state{border:unset;border-radius:unset}[_nghost-%COMP%]  .error-state{text-decoration:line-through}"],changeDetection:0})};c=(0,f.gn)([(0,g._s)(_.i),(0,f.w6)("design:paramtypes",[r.zs3,r.SBq,p.j])],c);let d=(()=>{class m{constructor(){this.component=c}static#t=this.\u0275fac=function(n){return new(n||m)};static#e=this.\u0275mod=r.oAB({type:m});static#n=this.\u0275inj=r.cJS({providers:[p.j],imports:[o.Y,p.X]})}return m})()},2996:(S,E,i)=>{i.d(E,{H:()=>x});var o=i(4966),p=i(4266),f=i(6733),r=i(9986);const g=["container"];function _(a,b){if(1&a&&(o.ynx(0),o._UZ(1,"nge-monaco-viewer",1),o.ALo(2,"json"),o.BQk()),2&a){const c=o.oxw();o.xp6(1),o.Q6J("code",o.lcZ(2,1,c.state))}}let x=(()=>{class a{constructor(c,d){this.api=c,this.elementRef=d,this.stateChange=new o.vpe}ngOnInit(){const c=this.elementRef.nativeElement,d=c.parentElement?.tagName.toLowerCase();this.definition=this.api.findBySelector(d||""),this.observer=new MutationObserver(m=>{m.forEach(this.onChangeAttributes.bind(this,!1))}),this.observer.observe(c.parentElement,{attributes:!0}),this.onChangeAttributes(!0)}ngOnDestroy(){this.observer?.disconnect()}parseValue(c){return c.trim().match(/^(true$|false$|\d+$|\[|\{)/)?JSON.parse(c):c}onChangeAttributes(c){const e=Array.from(this.elementRef.nativeElement.parentElement.attributes),t=e.find(h=>"cid"===h.name);if(t){const C=document.querySelector(`script[id="${t.value}"]`);return void(C&&(console.log(C.textContent),this.stateChange.emit(this.parseValue(C.textContent||"{}"))))}if(e.find(h=>"state"===h.name)&&c)return;const s={},l=this.definition?.schema?.properties||{};let u=!1;for(const h of e)if(h.name in l){u=!0;try{s[h.name]=this.parseValue(h.value)}catch{console.warn(`Invalid value "${h.value}" for ${h.name} attribute`)}}u&&this.stateChange.emit(s)}static#t=this.\u0275fac=function(d){return new(d||a)(o.Y36(p.G),o.Y36(o.SBq))};static#e=this.\u0275cmp=o.Xpm({type:a,selectors:[["wc-base"]],viewQuery:function(d,m){if(1&d&&o.Gf(g,5),2&d){let e;o.iGM(e=o.CRH())&&(m.container=e.first)}},inputs:{state:"state"},outputs:{stateChange:"stateChange"},decls:1,vars:1,consts:[[4,"ngIf"],["language","json",3,"code"]],template:function(d,m){1&d&&o.YNc(0,_,3,3,"ng-container",0),2&d&&o.Q6J("ngIf",null==m.state?null:m.state.debug)},dependencies:[f.O5,r.Yu,f.Ts],styles:["[_nghost-%COMP%]{display:block;margin:.5rem 0}div[_ngcontent-%COMP%]{display:none}"]})}return a})()},4104:(S,E,i)=>{i.d(E,{Y:()=>r});var o=i(6733),p=i(9986),f=i(4966);let r=(()=>{class g{static#t=this.\u0275fac=function(a){return new(a||g)};static#e=this.\u0275mod=f.oAB({type:g});static#n=this.\u0275inj=f.cJS({imports:[o.ez,p.vS,o.ez]})}return g})()}}]);